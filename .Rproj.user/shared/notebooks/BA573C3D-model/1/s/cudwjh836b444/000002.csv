"0",""
"0","modellist <- c(""lda"", ""glm"", ""svm"", ""knn"", ""nb"", ""cart"", ""c50"", ""treebag"", ""rf"", ""gbm"", ""adabag"")"
"0","leng <- 1:length(modellist)  "
"0","txt <- NULL"
"0","txt2 <- NULL"
"0","j <- 1"
"0","for (i in modellist) {"
"0","  modelnumber <- leng[j]"
"0","  library(""ROCR"")"
"0","  ### CONSTRUCTING ROC AUC PLOT:"
"0","  # Get the posteriors as a dataframe."
"0","  predictions <-predict(object = eval(parse(text=paste(""fit_"", i, ""_control_two_all"", sep=""""))), testing[,predictors], type = ""prob"")"
"0","  predictions.posteriors <- as.data.frame(predictions)"
"0","  "
"0","  # Evaluate the model"
"0","  pred <- prediction(predictions.posteriors[,2], testing[,3])"
"0","  roc.perf = performance(pred, measure = ""tpr"", x.measure = ""fpr"")"
"0","  auc.train <- performance(pred, measure = ""auc"")"
"0","  auc.train <- auc.train@y.values"
"0","  # Plot"
"0","  "
"0","  par(mar=c(5.1, 4.1, 4.1, 13), xpd=TRUE) "
"0","  "
"0","  if(modelnumber == 1) {"
"0","    plot(roc.perf, col = j, main = ""ROC Curve: Control Group Two VS. Experimental - All Variables"", cex.lab = 1.5, cex.main = 1.5)  "
"0","    #abline(a=0, b= 1)"
"0","    #text(x = .25, y = .65 ,paste(""AUC = "", round(auc.train[[1]],3), sep = """"))"
"0","  } else{"
"0","    plot(roc.perf, col = j, add = TRUE, main = ""ROC Curve: Control Group Two VS. Experimental - All Variables"", cex.lab = 1.5, cex.main = 1.5)"
"0","    #abline(a=0, b= 1)"
"0","    "
"0","  }"
"0","  txt[j] <- paste(i, "" AUC = "", round(auc.train[[1]],3), sep = """")"
"0","  txt2[j] <- round(auc.train[[1]],3)"
"0","  j <- j+1"
"0","  "
"0","}"
